import Observer from '../../../observer/Observer';
class Scale {
    constructor(slider, vertical) {
        this.$slider = slider;
        this.vertical = vertical;
        this.observer = new Observer();
        this.$scale = jQuery('<div>', {
            class: 'meta-slider__scale',
        }).appendTo(this.$slider);
        this.bindEventListeners();
    }
    initScale(stepsArr, vertical = false) {
        this.vertical = vertical;
        this.$scale.empty();
        const valuesArr = Scale.takeValues(stepsArr);
        this.addValues(valuesArr);
    }
    setVertical(vertical) {
        this.vertical = vertical;
    }
    static takeValues(stepsArr) {
        const scaleArr = [];
        const emptyStepsLength = Math.round(stepsArr.length / 10);
        const isStepsArrLengthBig = stepsArr.length > 10;
        stepsArr.forEach((item, i) => {
            const isLineInStep = i % emptyStepsLength === 0;
            const isValueSuitable = isStepsArrLengthBig && isLineInStep;
            const isAddValue = isValueSuitable || !isStepsArrLengthBig;
            if (isAddValue) {
                scaleArr.push({ item, index: i });
            }
        });
        if (scaleArr[scaleArr.length - 1].item !== stepsArr[stepsArr.length - 1]) {
            scaleArr.pop();
            scaleArr.push({ item: stepsArr[stepsArr.length - 1], index: stepsArr.length - 1 });
        }
        return scaleArr;
    }
    bindEventListeners() {
        $(this.$slider).on('click touchstart', this.sendScaleClickValue.bind(this));
    }
    sendScaleClickValue(event) {
        const { observer } = this;
        if (event.target.dataset.value) {
            const currentValue = Number(event.target.dataset.value);
            observer.notify('click', currentValue);
        }
    }
    addValues(valuesArr) {
        valuesArr.forEach((item) => {
            const line = jQuery('<div>', {
                class: 'meta-slider__line',
                text: this.vertical ? '\u2014' : '|',
                style: this.vertical ? `top: ${item.item.x - 10}px` : `left: ${item.item.x - 10}px`,
            }).appendTo(this.$scale);
            jQuery('<div>', {
                class: 'meta-slider__value js-meta-slider__value',
                'data-value': item.item.value,
                text: item.item.value,
            }).appendTo(line);
        });
    }
}
export default Scale;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NhbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvdmlldy9lbGVtZW50cy9zY2FsZS9zY2FsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLFFBQVEsTUFBTSw0QkFBNEIsQ0FBQztBQUlsRCxNQUFNLEtBQUs7SUFTVCxZQUFZLE1BQTJCLEVBQUUsUUFBaUI7UUFDeEQsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7UUFDdEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQy9CLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sRUFBRTtZQUM1QixLQUFLLEVBQUUsb0JBQW9CO1NBQzVCLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzFCLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFTSxTQUFTLENBQUMsUUFBcUIsRUFBRSxXQUFtQixLQUFLO1FBQzlELElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDcEIsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM3QyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFTSxXQUFXLENBQUMsUUFBaUI7UUFDbEMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVELE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBcUI7UUFDckMsTUFBTSxRQUFRLEdBQWdCLEVBQUUsQ0FBQztRQUNqQyxNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FB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