!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MetaSlider=t():e.MetaSlider=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,i)=>{for(var r in i)e.o(i,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.r(t),e.d(t,{default:()=>F});const r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observers=[]}var t,r;return t=e,(r=[{key:"subscribe",value:function(e){this.observers.push(e)}},{key:"notify",value:function(e,t){this.observers.forEach((function(i){i.key===e&&i.observer(t)}))}}])&&i(t.prototype,r),e}();function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const a=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=t,this.value=n,this.name=i,this.type="number"==typeof n?"number":"checkbox",this.$element=this.createInput(),this.$input=this.$element.find(".js-input__field"),this.observer=new r,this.setValue(this.value),this.bindEventListeners()}var t,i;return t=e,(i=[{key:"getName",value:function(){return this.name}},{key:"getValue",value:function(){var e=this.value;return"number"==typeof e&&Number(e),e}},{key:"setValue",value:function(e){this.value=e,"number"==typeof e?this.$input.val(e):this.$input.prop("checked",e)}},{key:"setProp",value:function(e,t){this.$input.prop(e,t)}},{key:"createInput",value:function(){var e=jQuery("<div>",{class:"input js-input"}).appendTo(this.$form),t=jQuery("<label>",{class:"input__label"}).appendTo(e);return jQuery("<p>",{class:"input__text",text:this.name}).appendTo(t),jQuery("<input>",{class:"input__field js-input__field input__field_with-".concat(this.type),type:this.type,name:this.name}).appendTo(t),"checkbox"===this.type&&jQuery("<span>",{class:"input__box"}).appendTo(t),e}},{key:"bindEventListeners",value:function(){this.$input.on("change keyup",this.handleInputValueChange.bind(this))}},{key:"handleInputValueChange",value:function(e){switch(this.type){case"number":this.value=Number(e.target.value);break;case"checkbox":this.value=e.target.checked}var t={};t[this.name]=this.value,this.observer.notify("setting",t)}}])&&n(t.prototype,i),e}();function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$root=t,this.observer=new r,this.$panel=jQuery("<div>",{class:"panel js-panel"}).appendTo(this.$root),this.$form=jQuery("<form>",{class:"panel__form js-panel__form"}).appendTo(this.$panel),this.inputs=new Map,this.bindEventListeners()}var t,i,n;return t=e,n=[{key:"handlePanelFormSubmit",value:function(){return!1}}],(i=[{key:"initPanel",value:function(e){var t=this,i=this,r=new Map;Object.entries(e).forEach((function(e){var n=s(e,2),o=n[0],l=n[1],c=new a(t.$form,o,l);c.observer.subscribe({key:"setting",observer:i.changeSettings.bind(i)}),r.set(o,c),"step"===o&&(c.setProp("min",.1),c.setProp("step",.1))})),this.inputs=r}},{key:"initBounds",value:function(e){var t=this;Object.entries(e).forEach((function(e){var i=s(e,2),r=i[0],n=i[1],a={};a[r]=n,t.changeBounds(a)}))}},{key:"initValues",value:function(e){switch(e.length){case 1:var t=this.takeInputFromArr("max").getValue();this.takeInputFromArr("from").setValue(e[0].value),this.takeInputFromArr("from").setProp("max",t);break;case 2:this.takeInputFromArr("from").setValue(e[0].value),this.takeInputFromArr("to").setValue(e[1].value),this.takeInputFromArr("from").setProp("max",e[1].value),this.takeInputFromArr("to").setProp("min",e[0].value);break;default:throw new Error("undefined values")}}},{key:"setValue",value:function(e){var t=Object.keys(e)[0],i=Object.values(e)[0];this.takeInputFromArr(t).setValue(i)}},{key:"takeInputFromArr",value:function(e){var t=this.inputs.get(e);if(t)return t;throw new Error("no such input")}},{key:"bindEventListeners",value:function(){this.$form.on("submit",e.handlePanelFormSubmit)}},{key:"changeSettings",value:function(e){this.changeBounds(e),this.observer.notify("setting",e)}},{key:"changeBounds",value:function(e){var t=Object.keys(e)[0],i=Object.values(e)[0],r=this.takeInputFromArr("max"),n=this.takeInputFromArr("min"),a=this.takeInputFromArr("step"),s=this.takeInputFromArr("from"),o=this.takeInputFromArr("to"),l=this.takeInputFromArr("range"),c=Number(r.getValue())-Number(n.getValue());switch(t){case"min":r.setProp("min",i),a.setProp("max",c),s.setProp("min",i);break;case"max":n.setProp("max",i),a.setProp("max",c),s.setProp("max",l.getValue()?o.getValue():i),o.setProp("max",i);break;case"step":s.setProp("step",i),o.setProp("step",i);break;case"from":o.setProp("min",i);break;case"to":s.setProp("max",i);break;case"range":var u=i?o.getValue():r.getValue();o.setProp("disabled",!i),s.setProp("max",u);break;case"vertical":case"tip":break;default:throw new Error("undefined setting")}}}])&&l(t.prototype,i),n&&l(t,n),e}();function u(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.vertical=!1,this.$track=jQuery("<div>",{class:"meta-slider__track"}).appendTo(this.$slider),this.observer=new r,this.position={top:0,left:0},this.trackStart=0}var t,i;return t=e,(i=[{key:"init",value:function(e){this.vertical=e,this.position=this.$track.position(),this.trackStart=this.vertical?Number(this.position.top):Number(this.position.left),this.bindEventListeners()}},{key:"getTrackParameters",value:function(){var e=this.vertical?Number(this.position.top):Number(this.position.left),t=this.vertical?this.$track.height():this.$track.width();return this.trackStart=e,{trackStart:e,trackWidth:t}}},{key:"setVertical",value:function(e){this.vertical=e}},{key:"bindEventListeners",value:function(){this.$track.on("click",this.handleTrackClick.bind(this))}},{key:"handleTrackClick",value:function(e){var t=this.vertical?e.pageY:e.pageX,i=Math.round(t-this.trackStart);this.observer.notify("trackClick",i)}}])&&u(t.prototype,i),e}();function v(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.vertical=!1,this.observer=new r,this.$scale=jQuery("<div>",{class:"meta-slider__scale"}).appendTo(this.$slider),this.stepsArr=[],this.itemWidth=20}var t,i;return t=e,(i=[{key:"init",value:function(e,t){this.vertical=t,this.stepsArr=e,this.$scale.empty(),this.itemWidth=this.takeWidth(),this.addValues(),this.bindEventListeners()}},{key:"takeWidth",value:function(){var e=this,t=[];[].concat(v(this.stepsArr.slice(0,3)),v(this.stepsArr.slice(-3))).forEach((function(i){var r=jQuery("<div>",{text:i.value}).appendTo(e.$scale);r.css(e.vertical?"height":"width","min-content");var n=e.vertical?$(r).height():$(r).width();if(void 0===n)throw new Error("wrong width of item");t.push(n),r.remove()}));var i=Math.max.apply(null,t);return this.vertical?i:i+10}},{key:"addValues",value:function(){var e=this,t=this.correctScaleArr(),i=Number(t[t.length-1].position),r=Number(t[t.length-2].position);Math.abs(r-i)<this.itemWidth&&t.splice(t.length-2,1),t.forEach((function(t){e.addItem(t)}))}},{key:"correctScaleArr",value:function(){var e=this,t=this.takeMaxStepsCount(),i=Math.round(this.stepsArr.length/t),r=this.stepsArr.length<t;return this.stepsArr.filter((function(t,n){return!(n%i!=0&&n!==e.stepsArr.length-1&&!r)&&t}))}},{key:"takeMaxStepsCount",value:function(){var e=this.vertical?this.$scale.height():this.$scale.width();if(void 0!==e){var t=e/this.itemWidth;return Math.floor(t)}throw new Error("wrong scale width")}},{key:"addItem",value:function(e){var t=e.position-this.itemWidth/2,i=jQuery("<div>",{class:"meta-slider__scale-item",style:this.vertical?"top: ".concat(t,"px"):"left: ".concat(t,"px")});return jQuery("<div>",{class:"meta-slider__line",text:this.vertical?"—":"|"}).appendTo(i),jQuery("<div>",{class:"meta-slider__value js-meta-slider__value","data-value":e.value,text:e.value,style:this.vertical?"height: ".concat(this.itemWidth,"px"):"width: ".concat(this.itemWidth,"px")}).appendTo(i),i.appendTo(this.$scale),i}},{key:"bindEventListeners",value:function(){$(this.$scale).on("click touchstart",this.sendScaleClickValue.bind(this))}},{key:"sendScaleClickValue",value:function(e){var t=this.observer;if(e.target.dataset.value){var i=Number(e.target.dataset.value);t.notify("scaleClick",i)}}}])&&p(t.prototype,i),e}();function m(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$track=this.$slider.find(".meta-slider__track"),this.vertical=!1,this.observer=new r,this.handles=this.initHandles()}var t,i,n;return t=e,i=[{key:"init",value:function(e,t){this.vertical=e,this.correctHandlesByRange(t)}},{key:"correctHandlesByRange",value:function(e){if(e&&1===this.handles.length){var t=jQuery("<div>",{class:"meta-slider__handle meta-slider__handle_right"}).appendTo(this.$track);this.handles.push(t)}else e||2!==this.handles.length||(this.handles[1].remove(),this.handles.pop());this.bindEventListeners()}},{key:"moveHandles",value:function(e){var t=this;this.handles.forEach((function(i,r){i.css(t.vertical?"top":"left","".concat(e[r].position-10,"px")),i.css(t.vertical?"left":"top","-5px")}))}},{key:"setVertical",value:function(e){this.vertical=e}},{key:"getVertical",value:function(){return this.vertical}},{key:"getHandles",value:function(){return this.handles}},{key:"bindEventListeners",value:function(){var e=this;this.handles.forEach((function(t){t.on("mousedown touchstart",e.handleHandleMouseDown.bind(e))}))}},{key:"handleHandleMouseDown",value:function(t){t.preventDefault();var i=t.target,r=$(i).hasClass("meta-slider__handle_left")?0:1;$(document).on("mousemove",this.handleMouseMove.bind(this,r)),$(document).on("touchmove",this.handleTouchMove.bind(this,r)),$(document).on("mouseup touchend",this.handleMoveEnd.bind(this)),$(document).on("dragstart",e.handleDragStart)}},{key:"handleMouseMove",value:function(e,t){var i={eventPosition:this.vertical?t.pageY:t.pageX,index:e};this.observer.notify("mouseMove",i)}},{key:"handleTouchMove",value:function(e,t){var i=null==t?void 0:t.touches;if(void 0!==i){var r=i[0],n={eventPosition:this.vertical?r.pageY:r.pageX,index:e};this.observer.notify("mouseMove",n)}}},{key:"handleMoveEnd",value:function(e){this.observer.notify("moveEnd",0),$(document).off("mousemove mouseup touchmove touchend")}},{key:"initHandles",value:function(){var e=[],t=jQuery("<div>",{class:"meta-slider__handle meta-slider__handle_left"}).appendTo(this.$track);e.push(t);var i=jQuery("<div>",{class:"meta-slider__handle meta-slider__handle_right"}).appendTo(this.$track);return e.push(i),e}}],n=[{key:"handleDragStart",value:function(){return!1}}],i&&m(t.prototype,i),n&&m(t,n),e}();const b=y;function k(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$track=$(this.$slider).find(".meta-slider__track"),this.$interval=jQuery("<div>",{class:"meta-slider__interval"}).appendTo(this.$track),this.vertical=!1}var t,i;return t=e,(i=[{key:"init",value:function(e){this.vertical=e}},{key:"moveInterval",value:function(e){var t,i;if(1===e.length)t=0,i=e[0].position-10-2;else{if(2!==e.length)throw new Error("wrong number of handles");t=Math.min(e[0].position,e[1].position)+10,i=Math.abs(e[1].position-e[0].position)-20-2}i=i>0?i:0,this.$interval.css(this.vertical?"height":"width","".concat(i,"px")),this.$interval.css(this.vertical?"width":"height","10px"),this.$interval.css(this.vertical?"top":"left","".concat(t,"px")),this.$interval.css(this.vertical?"left":"top","0px")}}])&&k(t.prototype,i),e}();function w(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$tips=[],this.$tip=jQuery("<div>",{class:"meta-slider__tip"})}var t,i;return t=e,i=[{key:"init",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this;if(this.$slider.find(".meta-slider__tip").remove(),this.$tips=[],e){var i=this.$slider.find(".meta-slider__handle");i.each((function(){var e=t.$tip.clone();e.appendTo($(this)),t.$tips.push(e)}))}}},{key:"changeTips",value:function(e){this.$tips.forEach((function(t,i){t.html("".concat(e[i].value))}))}}],i&&w(t.prototype,i),e}();const _=P;function j(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const x=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.config=i,this.observer=new r,this.$container=jQuery("<div>",{class:"meta-slider__container meta-slider__container_".concat(this.config.vertical?"vertical":"horizontal")}).appendTo(this.$slider),this.track=new h(this.$container),this.track.init(this.config.vertical),this.scale=new d(this.$container),this.handles=new b(this.$container),this.tips=new _(this.$container),this.interval=new g(this.$container),this.panel=void 0}var t,i;return t=e,i=[{key:"init",value:function(e){this.track.init(this.config.vertical),this.track.observer.subscribe({key:"trackClick",observer:this.changePositionByTrack.bind(this)}),this.handles.init(this.config.vertical,this.config.range),this.handles.correctHandlesByRange(this.config.range),this.handles.observer.subscribe({key:"mouseMove",observer:this.mouseMove.bind(this)}),this.handles.observer.subscribe({key:"moveEnd",observer:this.mouseMoveEnd.bind(this)}),this.tips.init(this.config.tip),this.interval.init(this.config.vertical),this.scale.init(e,this.config.vertical),this.scale.observer.subscribe({key:"scaleClick",observer:this.scaleClick.bind(this)})}},{key:"getTrackParameters",value:function(){return this.track.getTrackParameters()}},{key:"setParameters",value:function(e){this.handles.moveHandles(e),this.tips.changeTips(e),this.interval.moveInterval(e),void 0!==this.panel&&this.panel.initValues(e)}},{key:"initScale",value:function(e){this.scale.init(e,this.config.vertical)}},{key:"correctHandlesByRange",value:function(e){this.handles.correctHandlesByRange(e)}},{key:"initTips",value:function(e){this.tips.init(e)}},{key:"changeTips",value:function(e){this.tips.changeTips(e)}},{key:"changeDirection",value:function(e){this.config=e,this.track.init(e.vertical),this.$container.removeClass("meta-slider__container_".concat(e.vertical?"horizontal":"vertical")).addClass("meta-slider__container_".concat(e.vertical?"vertical":"horizontal"))}},{key:"setSettings",value:function(e){void 0!==this.panel&&this.panel.setValue(e)}},{key:"initPanel",value:function(e){this.panel=new c(this.$slider),this.panel.observer.subscribe({key:"setting",observer:this.changeSettings.bind(this)}),this.panel.initPanel(e),this.panel.initBounds(e)}},{key:"changePositionByTrack",value:function(e){this.observer.notify("trackClick",e)}},{key:"scaleClick",value:function(e){this.observer.notify("scaleClick",e)}},{key:"changeSettings",value:function(e){this.observer.notify("setting",e)}},{key:"mouseMove",value:function(e){this.observer.notify("mouseMove",e)}},{key:"mouseMoveEnd",value:function(e){this.observer.notify("moveEnd",e)}}],i&&j(t.prototype,i),e}();function T(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?T(Object(i),!0).forEach((function(t){S(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function S(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A={min:10,max:40,step:4,from:8,to:24,vertical:!1,tip:!0,range:!0},E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=this.correctOptionsType(t),this.config=$.extend({},A,this.options),this.correctMinMax(),this.trackStart=0,this.trackWidth=500,this.stepsArr=[],this.parameters=[]}var t,i,r;return t=e,i=[{key:"correctMinMax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config,t=C({},e);return t.max=e.max>e.min?e.max:e.min,t.min=e.max>e.min?e.min:e.max,t.max=e.max===e.min?e.min+10:t.max,this.config=t,t}},{key:"initStepsArr",value:function(){var e=this.config,t=e.min,i=e.max,r=e.step,n=i-t,a=this.trackWidth/n*r,s=a<1?Math.floor(1/a):1,o=Math.floor(n/r/s),l=Array(o+1),c=10*r*s,u=a*s,h=[],v=Array.from(l,(function(e,i){return t+Math.round(c*i)/10}));return h=v.map((function(e,t){return{value:Math.round(10*e)/10,position:Math.round(u*t)}})),v[v.length-1]!==i&&h.push({value:i,position:this.trackWidth}),this.stepsArr=h,h}},{key:"correctFromTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config,i=C({},t),r=this.stepsArr.map((function(e){return e.value})),n=e.takeClosestNum(i.from,r),a=e.takeClosestNum(i.to,r);return this.config.range?(i.from=n<a?n:a,i.to=n<a?a:n):i.from=n,this.config=i,i}},{key:"initParameters",value:function(){var t=[],i={value:this.config.from,position:0},r=this.stepsArr.map((function(e){return e.value})),n=e.takeClosestIndex(i.value,r);if(i.position=this.stepsArr[n].position,t.push(i),this.config.range){var a={value:this.config.to,position:0},s=e.takeClosestIndex(a.value,r);a.position=this.stepsArr[s].position,t.push(a)}return this.parameters=t,t}},{key:"takeParamHandleMove",value:function(t){var i=t.eventPosition,r=t.index,n=Math.round(i-this.trackStart);if(n>=0&&n<=this.trackWidth){var a=this.stepsArr.map((function(e){return e.position})),s=e.takeClosestIndex(n,a),o=this.stepsArr[s];return this.parameters[r].value=o.value,this.parameters[r].position=o.position,this.parameters}return!1}},{key:"correctFromToByParams",value:function(){return this.config.range?(this.config.from=Math.min(this.parameters[0].value,this.parameters[1].value),this.config.to=Math.max(this.parameters[0].value,this.parameters[1].value)):this.config.from=this.parameters[0].value,{from:this.config.from,to:this.config.to}}},{key:"takeParamScaleClick",value:function(t){if(this.config.range){var i=[this.parameters[0].value,this.parameters[1].value],r=e.takeClosestIndex(t,i);return this.parameters[r].value=t,this.parameters[r].position=this.takeXByValue(t),this.parameters}return this.parameters[0].value=t,this.parameters[0].position=this.takeXByValue(t),this.parameters}},{key:"takeParamTrackClick",value:function(t){var i=this.stepsArr.map((function(e){return e.position})),r=e.takeClosestNum(t,i);if(this.config.range){var n=[this.parameters[0].position,this.parameters[1].position],a=e.takeClosestIndex(r,n);return this.parameters[a].position=r,this.parameters[a].value=this.takeValueByX(r),this.parameters}return this.parameters[0].position=r,this.parameters[0].value=this.takeValueByX(r),this.parameters}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){this.config=e}},{key:"setSetting",value:function(e){this.config=$.extend({},this.config,e)}},{key:"getParameters",value:function(){return this.parameters}},{key:"setVertical",value:function(e){this.config.vertical=e}},{key:"setTrackParameters",value:function(e,t){this.trackStart=e,this.trackWidth=void 0===t?500:t}},{key:"getStepsArr",value:function(){return this.stepsArr}},{key:"correctOptionsType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=C({},e);return t.max=Number.isInteger(e.max)?Math.round(e.max):A.max,t.min=Number.isInteger(e.min)?Math.round(e.min):A.min,t.step=Number.isInteger(e.step)?Math.round(e.step):A.step,t.from=Number.isInteger(e.from)?Math.round(e.from):A.from,t.to=Number.isInteger(e.to)?Math.round(e.to):A.to,t.vertical="boolean"==typeof e.vertical?e.vertical:A.vertical,t.tip="boolean"==typeof e.tip?e.tip:A.tip,t.range="boolean"==typeof e.range?e.range:A.range,t}},{key:"takeXByValue",value:function(e){var t=this.stepsArr.find((function(t){return t.value===e}));if(t)return t.position;throw new Error("position for this value is not consist")}},{key:"takeValueByX",value:function(e){var t=this.stepsArr.find((function(t){return t.position===e}));if(t)return t.value;throw new Error("value for this position is not consist")}}],r=[{key:"takeClosestNum",value:function(t,i){return i[e.takeClosestIndex(t,i)]}},{key:"takeClosestIndex",value:function(e,t){var i=t.reduce((function(t,i){return Math.abs(i-e)<Math.abs(t-e)?i:t}));return t.indexOf(i)}}],i&&M(t.prototype,i),r&&M(t,r),e}();const O=E;function I(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const V=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=i,this.$root=t,this.$slider=jQuery("<div>",{class:"meta-slider"}).prependTo(this.$root),this.model=new O(this.options),this.vertical=this.model.getConfig().vertical,this.view=new x(this.$slider,this.model.getConfig()),this.view.observer.subscribe({key:"mouseMove",observer:this.moveHandle.bind(this)}),this.view.observer.subscribe({key:"moveEnd",observer:this.moveEnd.bind(this)}),this.view.observer.subscribe({key:"scaleClick",observer:this.clickOnScale.bind(this)}),this.view.observer.subscribe({key:"trackClick",observer:this.changePositionByTrack.bind(this)}),this.$slider.addClass(this.vertical?"meta-slider_vertical":"meta-slider_horizontal")}var t,i;return t=e,(i=[{key:"init",value:function(){var e=this.view.getTrackParameters(),t=e.trackStart,i=e.trackWidth;this.model.setTrackParameters(t,i);var r=this.model.initStepsArr();this.view.init(r),this.model.correctFromTo();var n=this.model.initParameters();this.view.setParameters(n)}},{key:"addPanel",value:function(){this.view.initPanel(this.model.getConfig()),this.view.observer.subscribe({key:"setting",observer:this.changeSettings.bind(this)})}},{key:"moveHandle",value:function(e){var t=this.model.takeParamHandleMove(e);"boolean"!=typeof t&&this.view.setParameters(t)}},{key:"moveEnd",value:function(){var e=this.model.correctFromToByParams(),t=e.from,i=e.to;this.view.setSettings({from:t}),this.view.setSettings({to:i}),this.view.setParameters(this.model.getParameters())}},{key:"clickOnScale",value:function(e){var t=this.model.takeParamScaleClick(e);t&&this.view.setParameters(t)}},{key:"changeSettings",value:function(e){this.model.setSetting(e);var t=this.model.getConfig();switch(Object.keys(e)[0]){case"min":case"max":case"step":this.view.initScale(this.model.initStepsArr()),this.model.correctFromTo(),this.view.setParameters(this.model.initParameters());break;case"from":case"to":this.view.setParameters(this.model.initParameters());break;case"range":this.view.correctHandlesByRange(t.range),this.view.initTips(t.tip),this.view.setParameters(this.model.initParameters());break;case"tip":this.view.initTips(t.tip),this.view.changeTips(this.model.getParameters());break;case"vertical":this.vertical=!this.vertical,this.model.setVertical(this.vertical),this.$slider.removeClass(this.vertical?"meta-slider_horizontal":"meta-slider_vertical"),this.$slider.addClass(this.vertical?"meta-slider_vertical":"meta-slider_horizontal"),this.view.changeDirection(this.model.getConfig()),this.init();break;default:throw new Error("undefined setting")}}},{key:"changePositionByTrack",value:function(e){var t=this.model.takeParamTrackClick(e);t&&this.view.setParameters(t)}}])&&I(t.prototype,i),e}();function B(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const F=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=new V(t,i),this.controller.init()}var t,i;return t=e,(i=[{key:"addPanel",value:function(){this.controller.addPanel()}}])&&B(t.prototype,i),e}();return t})()}));