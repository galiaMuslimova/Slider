!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MetaSlider=t():e.MetaSlider=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.r(t),e.d(t,{default:()=>N});const i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observers=[]}var t,i;return t=e,(i=[{key:"subscribe",value:function(e){this.observers.push(e)}},{key:"unsubscribe",value:function(e){this.observers=this.observers.filter((function(t){return t!==e}))}},{key:"notify",value:function(e,t){this.observers.forEach((function(n){n.key===e&&n.observer(t)}))}}])&&n(t.prototype,i),e}();function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$root=t,this.observer=new i,t.append('<div class="meta-slider__settings">\n      <form>\n        <label class="number">\n          <p class="text number__text">min</p>\n          <input class="box number__input" type="number" name="min" value="0" />\n        </label>\n      </form>\n      <form>\n        <label class="number">\n          <p class="text number__text">max</p>\n          <input class="box number__input" type="number" name="max" value="50" />\n        </label>\n      </form>\n      <form>\n        <label class="number">\n          <p class="text number__text">step</p>\n          <input class="box number__input" type="number" name="step" value="5" />\n        </label>\n      </form>\n      <form>\n        <label class="number">\n          <p class="text number__text">from</p>\n          <input class="box number__input" type="number" name="from" value="10" />\n        </label>\n      </form>\n      <form>\n        <label class="number">\n          <p class="text number__text">to</p>\n          <input class="box number__input" type="number" name="to" value="40" />\n        </label>\n      </form>\n      <form>\n        <label class="toggle">\n          <p class="text toggle__text">vertical</p>\n          <input class="toggle__input" type="checkbox" name="vertical">\n          <span class="box toggle__box"></span>          \n        </label> \n      </form>\n      <form>\n        <label class="toggle">\n          <p class="text toggle__text">tip</p>\n          <input class="toggle__input" type="checkbox" name="tip">\n          <span class="box toggle__box"></span>          \n        </label>        \n      </form>\n      <form>\n        <label class="toggle">\n          <p class="text toggle__text">range</p>\n          <input class="toggle__input" type="checkbox" name="range">\n          <span class="box toggle__box"></span>          \n        </label>        \n      </form>\n    </div>'),this.$settings=$(this.$root).find(".meta-slider__settings"),this.$max=this.$settings.find('input[name="max"]'),this.$min=this.$settings.find('input[name="min"]'),this.$step=this.$settings.find('input[name="step"]'),this.$from=this.$settings.find('input[name="from"]'),this.$to=this.$settings.find('input[name="to"]'),this.$vertical=this.$settings.find('input[name="vertical"]'),this.$range=this.$settings.find('input[name="range"]'),this.$tip=this.$settings.find('input[name="tip"]')}var t,n;return t=e,n=[{key:"initSettings",value:function(e){var t=this,n=this,i=this.observer;Object.entries(e).forEach((function(e){var a,s,o=(s=2,function(e){if(Array.isArray(e))return e}(a=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw r}}return a}}(a,s)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(a,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=o[0],c=o[1],u=t.$settings.find("input[name='".concat(l,"']")),h={};switch(h[l]=c,l){case"min":case"max":case"step":case"from":case"to":u.val(c),u.on("change",(function(){h[l]=Number(u.val()),i.notify("settings",h)}));break;case"vertical":case"tip":case"range":u.prop("checked",c),u.on("change",(function(){h[l]=u.prop("checked"),i.notify("settings",h)}));break;default:throw new Error("undefined setting")}switch(l){case"min":case"max":case"from":case"to":case"range":n.changeBounds(h),u.on("change",(function(){n.changeBounds(h)}));break;case"step":u.prop("min",0)}}))}},{key:"initValues",value:function(e){switch(e.length){case 1:var t=this.$max.val();this.$from.val(e[0]),this.$from.prop("max",t);break;case 2:this.$from.val(e[0]),this.$to.val(e[1]),this.$from.prop("max",e[1]),this.$to.prop("min",e[0]);break;default:throw new Error("undefined values")}}},{key:"changeBounds",value:function(e){var t,n=Object.keys(e)[0],i=Object.values(e)[0];switch(n){case"min":this.$max.prop("min",i),this.$from.prop("min",i),t=Number(this.$max.val())-i,this.$step.prop("max",t);break;case"max":this.$min.prop("max",i),this.$to.prop("max",i),t=i-Number(this.$min.val()),this.$step.prop("max",t);break;case"from":this.$to.prop("min",i);break;case"to":this.$from.prop("max",i);break;case"range":var r=i?this.$to.val():this.$max.val();this.$to.prop("disabled",!i),this.$from.prop("max",r);break;default:throw new Error("undefined setting")}}}],n&&a(t.prototype,n),e}();function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$track=jQuery("<div>",{class:"meta-slider__track"}).appendTo(this.$slider),this.position=this.$track.position()}var t,n;return t=e,(n=[{key:"getTrackParameters",value:function(e){return{trackStart:Number(e?this.position.top:this.position.left),trackWidth:e?this.$track.height():this.$track.width()}}}])&&o(t.prototype,n),e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$scale=jQuery("<div>",{class:"meta-slider__scale"}).appendTo(this.$slider)}var t,n;return t=e,n=[{key:"initScale",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$scale.empty();var i=20;e.forEach((function(e){jQuery("<div>",{class:"meta-slider__value",data_value:e.value,text:e.value,style:n?"top: ".concat(e.x-i/2,"px"):"left: ".concat(e.x-i/2,"px")}).appendTo(t.$scale)}))}}],n&&c(t.prototype,n),e}();const h=u;function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.handles=[]}var t,n;return t=e,n=[{key:"initHandles",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.handles=[];var t=this.$slider.find(".meta-slider__handle");t.remove();var n=$(this.$slider).find(".meta-slider__track"),i=jQuery("<div>",{class:"meta-slider__handle meta-slider__handle_left"}).appendTo(n);if(this.handles.push(i),e){var r=jQuery("<div>",{class:"meta-slider__handle meta-slider__handle_right"}).appendTo(n);this.handles.push(r)}}},{key:"moveHandles",value:function(e,t){this.handles.forEach((function(n,i){n.css(t?"top":"left","".concat(e[i]-10,"px"))}))}}],n&&f(t.prototype,n),e}();const v=m;function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$track=$(this.$slider).find(".meta-slider__track"),jQuery("<div>",{class:"meta-slider__interval"}).appendTo(this.$track),this.$interval=this.$slider.find(".meta-slider__interval")}var t,n;return t=e,(n=[{key:"moveInterval",value:function(e,t){var n,i;if(1===e.length)n=0,i=e[0]-10-2;else{if(2!==e.length)throw new Error("wrong number of handles");var r=Math.min(e[0],e[1]);n=r+10,i=Math.max(e[0],e[1])-r-20-2}i=i>0?i:0,this.$interval.css(t?"height":"width","".concat(i,"px")),this.$interval.css(t?"top":"left","".concat(n,"px"))}}])&&p(t.prototype,n),e}();function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$slider=t,this.$handles=[],this.$tips=[],this.$tip=jQuery("<div>",{class:"meta-slider__tip"})}var t,n;return t=e,n=[{key:"initTips",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$slider.find(".meta-slider__tip").remove(),this.$tips=[];var t=this.$slider.find(".meta-slider__handle");if(e)for(var n=0;n<t.length;n+=1){var i=this.$tip.clone();i.appendTo($(t[n])),this.$tips.push(i)}}},{key:"changeTips",value:function(e){this.$tips.forEach((function(t,n){t.html("".concat(e[n]))}))}}],n&&b(t.prototype,n),e}();const y=g;function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var w=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$root=t,this.vertical=n,this.observer=new i,this.$container=jQuery("<div>",{class:"meta-slider ".concat(this.vertical?"meta-slider_vertical":"meta-slider_horizontal")}).appendTo(this.$root),this.$slider=jQuery("<div>",{class:"meta-slider__slider"}).appendTo(this.$container),this.track=new l(this.$slider),this.scale=new h(this.$slider),this.handles=new v(this.$slider),this.tips=new y(this.$slider),this.interval=new d(this.$slider),this.settings=new s(this.$container),this.settings.observer.subscribe({key:"settings",observer:this.changeSettings.bind(this)}),this.handleMove(),this.scaleClick()}var t,n,r;return t=e,n=[{key:"getTrackParameters",value:function(){return this.track.getTrackParameters(this.vertical)}},{key:"initScale",value:function(e){this.scale.initScale(e,this.vertical)}},{key:"initHandles",value:function(e){this.handles.initHandles(e)}},{key:"initTips",value:function(e){this.tips.initTips(e)}},{key:"changeTips",value:function(e){this.tips.changeTips(e)}},{key:"setParameters",value:function(e){this.handles.moveHandles(e.handleX,this.vertical),this.tips.changeTips(e.values),this.interval.moveInterval(e.handleX,this.vertical),this.settings.initValues(e.values)}},{key:"initSettings",value:function(e){this.settings.initSettings(e)}},{key:"handleMove",value:function(){var t=this.observer;this.$slider.on("mousedown touchstart",".meta-slider__handle",(function(n){var i=$(n.currentTarget).hasClass("meta-slider__handle_right")?1:0;$(document).on("mousemove",{index:i,observer:t},e.sendMouseMoveOptions),$(document).on("touchmove",{index:i,observer:t},e.sendTouchMoveOptions),$(document).on("mouseup touchend",(function(){$(document).off("mousemove mouseup touchmove touchend")})),$(document).on("dragstart",(function(){return!1}))}))}},{key:"scaleClick",value:function(){var t=this.observer;this.$slider.on("click touchstart",".meta-slider__value",{observer:t},e.sendScaleClickValue)}},{key:"changeSettings",value:function(e){this.observer.notify("settings",e)}}],r=[{key:"sendMouseMoveOptions",value:function(e){var t=e.data.index,n=e.data.observer,i={eventPosition:{pageX:e.pageX,pageY:e.pageY},index:t};n.notify("mousemove",i)}},{key:"sendTouchMoveOptions",value:function(e){var t=e.data.index,n=e.data.observer,i=e.originalEvent;if(void 0!==i){var r=i.touches;if(void 0!==r){var a=r[0],s={eventPosition:{pageX:a.pageX,pageY:a.pageY},index:t};n.notify("mousemove",s)}}}},{key:"sendScaleClickValue",value:function(e){var t=e.data.observer,n=Number($(e.currentTarget).attr("data_value"));t.notify("click",n)}}],n&&k(t.prototype,n),r&&k(t,r),e}();const x=w;function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var S={min:10,max:40,step:4,from:8,to:24,vertical:!1,tip:!0,range:!0},M=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;j(this,e),this.options=this.correctOptions(t),this.config=this.correctConfig($.extend({},S,this.options)),this.trackStart=n,this.trackWidth=i,this.range=this.config.max-this.config.min,this.positionsArr=this.initPositionsArr(),this.parameters=this.initParameters()}var t,n;return t=e,n=[{key:"correctOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options,t=P({},e);return t.max=Number.isInteger(e.max)?e.max:S.max,t.min=Number.isInteger(e.min)?e.min:S.min,t.step=Number.isInteger(e.step)?e.step:S.step,t.from=Number.isInteger(e.from)?e.from:S.from,t.to=Number.isInteger(e.to)?e.to:S.to,t}},{key:"correctConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config,t=P({},e);t.max=e.max>e.min?e.max:e.min,t.min=e.max>e.min?e.min:e.max,t.max=e.max===e.min?t.min+10:t.max,t.max=Math.round(t.max),t.min=Math.round(t.min);var n=t.max-t.min;this.range=n;var i=2*e.step<n&&20*e.step>n;t.step=i?Math.round(e.step):Math.round(n/10);var r=e.from<t.max&&e.from>=t.min,a=r?Math.round(e.from):t.min+t.step,s=e.to<=t.max&&e.to>t.min,o=s?Math.round(e.to):t.max-t.step;return t.from=a<o?a:o,t.to=a<o?o:a,t}},{key:"initStepsArr",value:function(){var e=this,t=this.trackWidth/this.range*this.config.step,n=Math.floor(this.range/this.config.step),i=Array(n+1),r=Array.from(i,(function(t,n){return e.config.min+e.config.step*n})),a=[];return r.map((function(e,n){return a.push({value:e,x:Math.round(t*n)})})),a}},{key:"initPositionsArr",value:function(){var e=this,t=this.trackWidth/this.range,n=Array.from(Array(this.range+1),(function(t,n){return e.config.min+n})),i=[];return n.map((function(e,n){return i.push({value:e,x:Math.round(t*n)})})),i}},{key:"initParameters",value:function(){var e={values:[],handleX:[]},t=this;return e.values[0]=this.config.from,this.config.range&&(e.values[1]=this.config.to),e.handleX=e.values.map((function(e){return t.takeXByValue(e)})),this.parameters=e,e}},{key:"takeXByValue",value:function(e){var t=this.positionsArr.find((function(t){return t.value===e}));if(t)return t.x;throw new Error("position for this value is not consist")}},{key:"takeParamHandleMove",value:function(e){var t=e.eventPosition.pageX,n=e.eventPosition.pageY,i=e.index,r=this.config.vertical?n:t,a=Math.round(r-this.trackStart);if(a>=0&&a<=this.trackWidth){var s=this.positionsArr.find((function(e){return e.x===a}));if(s){this.parameters.values[i]=s.value,this.parameters.handleX[i]=s.x;var o=this.parameters.values[0];return this.config.from=o,this.config.to=this.parameters.values[1]?this.parameters.values[1]:this.config.to,this.parameters}return!1}return!1}},{key:"takeParamScaleClick",value:function(e){if(this.config.range){var t=this.parameters.values.reduce((function(t,n){return Math.abs(n-e)<Math.abs(t-e)?n:t})),n=this.parameters.values.indexOf(t);return this.parameters.values[n]=e,this.parameters.handleX[n]=this.takeXByValue(e),this.parameters}return this.parameters.values=[e],this.parameters.handleX=[this.takeXByValue(e)],this.parameters}}],n&&T(t.prototype,n),e}();const E=M;function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var A=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=n,this.$root=t,this.vertical=void 0!==n.vertical&&n.vertical,this.view=new x(this.$root,this.vertical);var i=this.view.getTrackParameters(),r=i.trackStart,a=i.trackWidth;this.model=new E(this.options,r,a),this.init()}var t,n;return t=e,n=[{key:"init",value:function(){var e=this.model.initStepsArr();this.view.initScale(e);var t=this.model.config.range;this.view.initHandles(t);var n=this.model.config.tip;this.view.initTips(n);var i=this.model.initParameters();this.view.setParameters(i),this.view.observer.subscribe({key:"mousemove",observer:this.moveHandle.bind(this)}),this.view.observer.subscribe({key:"click",observer:this.clickOnScale.bind(this)}),this.view.initSettings(this.model.config),this.view.observer.subscribe({key:"settings",observer:this.changeSettings.bind(this)})}},{key:"moveHandle",value:function(e){var t=this.model.takeParamHandleMove(e);t&&this.view.setParameters(t)}},{key:"clickOnScale",value:function(e){var t=this.model.takeParamScaleClick(e);t&&this.view.setParameters(t)}},{key:"changeSettings",value:function(e){this.model.config=this.model.correctConfig($.extend({},this.model.config,e));var t=Object.keys(e)[0],n=Object.values(e)[0];switch(t){case"min":case"max":case"step":this.view.initScale(this.model.initStepsArr()),this.model.positionsArr=this.model.initPositionsArr(),this.view.setParameters(this.model.initParameters());break;case"from":case"to":this.view.setParameters(this.model.initParameters());break;case"range":this.view.initHandles(n),this.view.initTips(this.model.config.tip),this.view.setParameters(this.model.initParameters());break;case"tip":this.view.initTips(n),this.view.changeTips(this.model.parameters.values);break;case"vertical":this.options.vertical=!this.vertical,this.vertical=!this.vertical,this.$root.find(".meta-slider").remove(),this.view=new x(this.$root,this.vertical);var i=this.view.getTrackParameters(),r=i.trackStart,a=i.trackWidth;this.model=new E(this.options,r,a),this.init();break;default:throw new Error("undefined setting")}}}],n&&C(t.prototype,n),e}();const X=A;function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function I(e,t,n){return t&&H(e.prototype,t),n&&H(e,n),e}const N=I((function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controller=new X(t,n),this}));return t})()}));